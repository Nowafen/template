id: info-credential
info:
  name: Credential and Sensitive File Fuzzer
  author: MNM
  severity: low
  description: Fuzzing for sensitive files and endpoints that may expose credentials or configuration data
  tags: auth, fuzzing, files, info-disclosure, credentials
http:
  - method: GET
    path:
      - "{{BaseURL}}/package.json"
      - "{{BaseURL}}/package-lock.json"
      - "{{BaseURL}}/node_modules"
      - "{{BaseURL}}/webpack.config.js"
      - "{{BaseURL}}/vite.config.js"
      - "{{BaseURL}}/rollup.config.js"
      - "{{BaseURL}}/tsconfig.json"
      - "{{BaseURL}}/babel.config.js"
      - "{{BaseURL}}/eslintrc.js"
      - "{{BaseURL}}/eslintrc.json"
      - "{{BaseURL}}/prettierrc.json"
      - "{{BaseURL}}/jest.config.js"
      - "{{BaseURL}}/gulpfile.js"
      - "{{BaseURL}}/Gruntfile.js"
      - "{{BaseURL}}/config.js"
      - "{{BaseURL}}/config.json"
      - "{{BaseURL}}/env.js"
      - "{{BaseURL}}/.env"
      - "{{BaseURL}}/.env.local"
      - "{{BaseURL}}/.env.development"
      - "{{BaseURL}}/.env.production"
      - "{{BaseURL}}/app.js"
      - "{{BaseURL}}/server.js"
      - "{{BaseURL}}/index.js"
      - "{{BaseURL}}/main.js"
      - "{{BaseURL}}/db.js"
      - "{{BaseURL}}/database.js"
      - "{{BaseURL}}/dbconfig.js"
      - "{{BaseURL}}/dbconfig.json"
      - "{{BaseURL}}/knexfile.js"
      - "{{BaseURL}}/sequelize-config.js"
      - "{{BaseURL}}/migrations"
      - "{{BaseURL}}/seeds"
      - "{{BaseURL}}/database.sql"
      - "{{BaseURL}}/db.sql"
      - "{{BaseURL}}/backup.sql"
      - "{{BaseURL}}/dump.sql"
      - "{{BaseURL}}/schema.sql"
      - "{{BaseURL}}/structure.sql"
      - "{{BaseURL}}/data.sql"
      - "{{BaseURL}}/database.dump"
      - "{{BaseURL}}/db.backup"
      - "{{BaseURL}}/dbconfig.yaml"
      - "{{BaseURL}}/dbconfig.yml"
      - "{{BaseURL}}/prisma/schema.prisma"
      - "{{BaseURL}}/api/db.js"
      - "{{BaseURL}}/api/config.js"
      - "{{BaseURL}}/api/database.js"
      - "{{BaseURL}}/config/database.js"
      - "{{BaseURL}}/config/db.js"
      - "{{BaseURL}}/scripts/dbseed.js"
      - "{{BaseURL}}/scripts/migrate.js"
      - "{{BaseURL}}/scripts/setupdb.js"
      - "{{BaseURL}}/.gitignore"
      - "{{BaseURL}}/docker-compose.yml"
      - "{{BaseURL}}/Dockerfile"
      - "{{BaseURL}}/db/migration.sql"
      - "{{BaseURL}}/db/seed.sql"
      - "{{BaseURL}}/admin/dbconfig.js"
      - "{{BaseURL}}/admin/database.js"
      - "{{BaseURL}}/tests/db.test.js"
      - "{{BaseURL}}/tests/setup.js"
      - "{{BaseURL}}/src/config.js"
      - "{{BaseURL}}/src/db.js"
      - "{{BaseURL}}/src/database.js"
      - "{{BaseURL}}/src/index.js"
      - "{{BaseURL}}/dist/main.js"
      - "{{BaseURL}}/dist/bundle.js"
      - "{{BaseURL}}/public/js/app.js"
      - "{{BaseURL}}/public/js/main.js"
      - "{{BaseURL}}/assets/js/config.js"
      - "{{BaseURL}}/assets/js/db.js"
    matchers-condition: and
    matchers:
      - type: status
        status:
          - 200
      - type: dsl
        dsl:
          - "contains(tolower(header), 'application/json') || contains(tolower(header), 'text/javascript') || contains(tolower(header), 'text/plain') || contains(tolower(header), 'text/x-yaml') || contains(tolower(header), 'application/x-yaml')"
        condition: or
      - type: word
        words:
          - "password"
          - "secret"
          - "api_key"
          - "apiKey"
          - "token"
          - "access_key"
          - "secret_key"
          - "aws_access_key"
          - "aws_secret_key"
          - "db_password"
          - "database_password"
          - "db_user"
          - "connection_string"
          - "db_connection"
          - "private_key"
          - "jwt_secret"
          - "auth_token"
          - "session_key"
          - "encryption_key"
          - "credential"
        part: body
        condition: or
      - type: word
        words:
          - "<html"
          - "<title>Index of"
          - "Directory listing for"
        part: body
        negative: true
        condition: or
